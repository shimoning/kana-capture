(function(l,h){typeof exports=="object"&&typeof module<"u"?h(exports):typeof define=="function"&&define.amd?define(["exports"],h):(l=typeof globalThis<"u"?globalThis:l||self,h(l.KanaCapture={}))})(this,function(l){"use strict";function h(e,o){if(!e.length||!o.length)return{before:e,after:o,diff:o,same:"",gap:0};if(e===o)return{before:e,after:o,diff:"",same:e,gap:0};const t=e.split(""),s=o.split(""),r=Math.max(t.length,s.length),c=[],N=[];let K=0;for(let A=0;A<r;A++){const v=t[A];for(let i=A+K;i<r;i++,K++){const L=s[i];if(v===L){c.push(v);break}N.push(L)}}return{before:e,after:o,diff:N.join(""),same:c.join(""),gap:K}}var b=(e=>(e[e.HIRAGANA=0]="HIRAGANA",e[e.KUTOUTEN=1]="KUTOUTEN",e[e.CHOUON=2]="CHOUON",e[e.KAGIKAKKO=3]="KAGIKAKKO",e[e.ZENKAKU_SPACE=4]="ZENKAKU_SPACE",e[e.HANKAKU_SPACE=5]="HANKAKU_SPACE",e[e.ZENKAKU_ALPHABET=6]="ZENKAKU_ALPHABET",e[e.HANKAKU_ALPHABET=7]="HANKAKU_ALPHABET",e[e.ZENKAKU_NUMBER=8]="ZENKAKU_NUMBER",e[e.HANKAKU_NUMBER=9]="HANKAKU_NUMBER",e[e.ZENKAKU_1BYTE_SYMBOL=10]="ZENKAKU_1BYTE_SYMBOL",e[e.HANKAKU_1BYTE_SYMBOL=11]="HANKAKU_1BYTE_SYMBOL",e))(b||{});const T={0:/[ぁ-ん]/g,1:/[、。]/g,2:/[ー]/g,3:/[「」]/g,4:/[　]/g,5:/[ ]/g,6:/[Ａ-Ｚａ-ｚ]/g,7:/[A-Za-z]/g,8:/[０-９]/g,9:/[0-9]/g,10:/[！＂”＃＄％＆＇’（）＊＋，－．／：；＜＝＞？＠［￥］＾＿｀“｛｜｝～]/g,11:/[!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~]/g};function B({input:e,patterns:o=0}){const t=o instanceof RegExp?o:R(o),s=e.replace(t,"");return s.length===0?e:e.replace(new RegExp("["+s+"]","g"),"")}function R(e){const o=[],t=s=>{typeof s=="string"?o.push("["+s+"]"):s instanceof RegExp?o.push(s.source):o.push(T[s].source)};if(Array.isArray(e))for(const s of e)t(s);else t(e);return new RegExp(o.join("|"),"g")}function V(e){return e>=12353&&e<=12438||e>=12445&&e<=12446}function z(e){return e+96}const P={が:"ｶﾞ",ぎ:"ｷﾞ",ぐ:"ｸﾞ",げ:"ｹﾞ",ご:"ｺﾞ",ざ:"ｻﾞ",じ:"ｼﾞ",ず:"ｽﾞ",ぜ:"ｾﾞ",ぞ:"ｿﾞ",だ:"ﾀﾞ",ぢ:"ﾁﾞ",づ:"ﾂﾞ",で:"ﾃﾞ",ど:"ﾄﾞ",ば:"ﾊﾞ",び:"ﾋﾞ",ぶ:"ﾌﾞ",べ:"ﾍﾞ",ぼ:"ﾎﾞ",ぱ:"ﾊﾟ",ぴ:"ﾋﾟ",ぷ:"ﾌﾟ",ぺ:"ﾍﾟ",ぽ:"ﾎﾟ",ゔ:"ｳﾞ",あ:"ｱ",い:"ｲ",う:"ｳ",え:"ｴ",お:"ｵ",か:"ｶ",き:"ｷ",く:"ｸ",け:"ｹ",こ:"ｺ",さ:"ｻ",し:"ｼ",す:"ｽ",せ:"ｾ",そ:"ｿ",た:"ﾀ",ち:"ﾁ",つ:"ﾂ",て:"ﾃ",と:"ﾄ",な:"ﾅ",に:"ﾆ",ぬ:"ﾇ",ね:"ﾈ",の:"ﾉ",は:"ﾊ",ひ:"ﾋ",ふ:"ﾌ",へ:"ﾍ",ほ:"ﾎ",ま:"ﾏ",み:"ﾐ",む:"ﾑ",め:"ﾒ",も:"ﾓ",や:"ﾔ",ゆ:"ﾕ",よ:"ﾖ",ら:"ﾗ",り:"ﾘ",る:"ﾙ",れ:"ﾚ",ろ:"ﾛ",わ:"ﾜ",を:"ｦ",ん:"ﾝ",ぁ:"ｧ",ぃ:"ｨ",ぅ:"ｩ",ぇ:"ｪ",ぉ:"ｫ",っ:"ｯ",ゃ:"ｬ",ゅ:"ｭ",ょ:"ｮ","。":"｡","、":"､",ー:"ｰ","「":"｢","」":"｣","・":"･"},Z={Ａ:"A",Ｂ:"B",Ｃ:"C",Ｄ:"D",Ｅ:"E",Ｆ:"F",Ｇ:"G",Ｈ:"H",Ｉ:"I",Ｊ:"J",Ｋ:"K",Ｌ:"L",Ｍ:"M",Ｎ:"N",Ｏ:"O",Ｐ:"P",Ｑ:"Q",Ｒ:"R",Ｓ:"S",Ｔ:"T",Ｕ:"U",Ｖ:"V",Ｗ:"W",Ｘ:"X",Ｙ:"Y",Ｚ:"Z",ａ:"a",ｂ:"b",ｃ:"c",ｄ:"d",ｅ:"e",ｆ:"f",ｇ:"g",ｈ:"h",ｉ:"i",ｊ:"j",ｋ:"k",ｌ:"l",ｍ:"m",ｎ:"n",ｏ:"o",ｐ:"p",ｑ:"q",ｒ:"r",ｓ:"s",ｔ:"t",ｕ:"u",ｖ:"v",ｗ:"w",ｘ:"x",ｙ:"y",ｚ:"z"},x={"０":"0","１":"1","２":"2","３":"3","４":"4","５":"5","６":"6","７":"7","８":"8","９":"9"},Y={"　":" ","！":"!","＂":'"',"”":'"',"＃":"#","＄":"$","％":"%","＆":"&","＇":"'","’":"'","（":"(","）":")","＊":"*","＋":"+","，":",","－":"-","．":".","／":"/","：":":","；":";","＜":"<","＝":"=","＞":">","？":"?","＠":"@","［":"[","￥":"\\","］":"]","＾":"^","＿":"_","｀":"`","“":"`","｛":"{","｜":"|","｝":"}","～":"~"};var k=(e=>(e[e.Hiragana=0]="Hiragana",e[e.ZenkakuKatakana=1]="ZenkakuKatakana",e[e.HankakuKatakana=2]="HankakuKatakana",e))(k||{});function $(e,o){let t="";for(let s=0;s<o.length;s++){const r=o[s];if(e===0)t+=r;else if(e===1){const c=o.charCodeAt(s);V(c)?t+=String.fromCharCode(z(c)):t+=r}else e===2&&(typeof P[r]=="string"?t+=P[r]:typeof Z[r]=="string"?t+=Z[r]:typeof x[r]=="string"?t+=x[r]:typeof Y[r]=="string"?t+=Y[r]:t+=r)}return t}/**
 * @license
 * KanaCapture v0.3.0
 * Copyright (c) 2025 Shimoning, Inc.
 * Released under the MIT License.
 */var w=(e=>(e[e.REALTIME=0]="REALTIME",e[e.ENTER=1]="ENTER",e))(w||{});function F(e,o,t={observeInterval:30,debug:!1,realtime:!0,enter:!1,clearOnInputEmpty:!1,capturablePatterns:b.HIRAGANA}){const s=R(t.capturablePatterns??b.HIRAGANA),r=typeof e=="string"?document.querySelector(e):e;if(!r)throw new Error("input element not found");let c=0;const N=t.realtime instanceof HTMLInputElement,K=t.enter instanceof HTMLInputElement,A=!N&&!K;function v(){const n=t.realtime&&(t.realtime===!0||t.realtime instanceof HTMLInputElement&&t.realtime.checked),f=t.enter&&(t.enter===!0||t.enter instanceof HTMLInputElement&&t.enter.checked);c=n||!f?0:1}A&&v(),a("outputTiming",{outputTiming:c,outputTimingIsStatic:A,realtimeIsDynamic:N,enterIsDynamic:K});const i=[],L=n=>{if(typeof n=="string"){const f=document.querySelectorAll(n);for(const d of f)i.push({element:d,type:k.Hiragana})}else n instanceof HTMLInputElement?i.push({element:n,type:k.Hiragana}):i.push({element:n.element,type:n.type??k.Hiragana})};if(Array.isArray(o))for(const n of o)L(n);else L(o);let u=!1,m="",U="",_="";const H=new Array(i.length).fill("");function S(){a("reset"),m="",U="",_="";for(let n=0;n<i.length;n++)H[n]=""}function I(){m=r.value,i.forEach(({element:n},f)=>{H[f]=n.value}),a("setup",r.value,{defaultString:m,activeOutputs:i})}let g;function J(){a("start",{timer:g}),!g&&(g=setInterval(()=>{Q()},t.observeInterval??30))}function j(){a("end",{timer:g}),g&&(clearInterval(g),g=void 0)}function Q(){const n=r.value;if(a("observe",{composing:u,inputString:n,defaultString:m,currentString:U,outputValues:H}),n==="")return;const f=h(m,n);U!==f.diff&&(U=f.diff,M(U))}function M(n){a("set",{defaultString:m,string:n,inputValue:_,outputValues:H});const f=B({input:n,patterns:s});f.length===n.length&&(_=f),i.forEach(({element:d,type:y},D)=>{const O=$(y,_);a("converted",{type:y,string:n,inputValue:_,after:O,before:H[D],bufferKana:d.dataset.bufferKana,bufferOther:d.dataset.bufferOther}),c===0?d.value=H[D]+O:c===1&&W(d,O)})}function p(n){const f=B({input:n,patterns:s});n&&n===f&&(I(),M(f))}function W(n,f){a("set buffer",{composing:u,element:n,string:f}),u?n.dataset.bufferKana=f:n.dataset.bufferOther=(n.dataset.bufferOther??"")+f}function G(n){a("clear buffer"),n.dataset.bufferOther="",n.dataset.bufferKana=""}function q(n=!1){i.forEach(({element:f})=>{if(n){f.value="",G(f);return}const d=(f.dataset.bufferOther??"")+(f.dataset.bufferKana??"");d&&(f.value+=d,G(f))})}function a(n,...f){if(t.debug){if(f.length===0){console.log("%c[debug]","background-color: #ff6d13; color: #fffafa;",{message:n});return}console.log("%c[debug]","background-color: #ff6d13; color: #fffafa;",{message:n},...f)}}function E(n,...f){if(t.event){if(f.length===0){console.info("%c[event]","background-color: #fffafa; color: #303030;",{message:n});return}console.info("%c[event]","background-color: #fffafa; color: #303030;",{message:n},...f)}}r.addEventListener("focus",n=>{E("focus",{e:n}),I()}),r.addEventListener("blur",n=>{E("blur",{e:n}),j()}),r.addEventListener("compositionstart",n=>{E("compositionstart",{e:n}),I(),J(),u=!0}),r.addEventListener("compositionend",n=>{E("compositionend",{e:n,inputValue:_}),j(),S(),u=!1,["　"," "].includes(n.data)&&(a("spaces",'"'+n.data+'"'),p(n.data))}),r.addEventListener("beforeinput",n=>{E("beforeinput",{composing:u,e:n}),!u&&!n.isComposing&&n.data&&p(n.data)}),r.addEventListener("input",n=>{E("input",{composing:u,e:n})}),r.addEventListener("keydown",n=>{E("keydown",{composing:u,e:n})}),r.addEventListener("keyup",n=>{if(E("keyup",{composing:u,e:n},n.code),n.code==="Enter"){let f=!1;t.clearOnInputEmpty&&r.value===""&&(f=!0,S(),M("")),c===1&&q(f)}n.code==="Backspace"&&a("backspace",{outputTiming:c},r.value)}),t.realtime instanceof HTMLInputElement&&t.realtime.addEventListener("change",()=>{a("realtime change"),v(),q()}),t.enter instanceof HTMLInputElement&&t.enter.addEventListener("change",()=>{a("enter change"),v()})}l.CapturableCharacterType=b,l.KanaType=k,l.OutputTiming=w,l.setupObserver=F,Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=index.js.map
